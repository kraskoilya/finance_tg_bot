# finance_tg_bot

**finance_tg_bot** — это внутренний Telegram-бот для учёта личных финансов с интеграцией в Notion.

## Возможности

- Быстрое добавление доходов и расходов через Telegram
- Поддержка нескольких валют (доллар, рубль, лари)
- История последних операций
- Получение отчётов по расходам за неделю и месяц
- Интеграция с Notion для хранения и анализа данных
- Удобные inline-клавиатуры для пошагового ввода
- Защита доступа по user ID

## Используемые технологии

- [node-telegram-bot-api](https://github.com/yagop/node-telegram-bot-api) — работа с Telegram Bot
  API
- [@notionhq/client](https://github.com/makenotion/notion-sdk-js) — интеграция с Notion API
- Node.js

## Быстрый старт

1. **Клонируйте репозиторий:**
   ```bash
   git clone <repo_url>
   cd finance_tg_bot
   ```
2. **Установите зависимости:**
   ```bash
   npm install
   ```
3. **Настройте переменные окружения:**

   - `TELEGRAM_TOKEN` — токен Telegram-бота
   - `NOTION_TOKEN` — токен интеграции Notion
   - `NOTION_DATABASE_ID` — ID базы данных Notion
   - `ALLOWED_USER_ID` — разрешённый Telegram user ID

   Можно задать их через `.env` или напрямую в `config.js`.

4. **Запустите бота:**
   ```bash
   node bot.js
   ```

## Основные команды

- `/start` — начать работу с ботом
- `/help` — инструкция по использованию
- `/cancel` — отменить текущий ввод
- `/history` — показать последние операции
- `/total` — показать доходы и расходы за сегодня

## Как работает бот

1. Пользователь запускает бота и выбирает тип операции (доход/расход)
2. Выбирает валюту
3. Вводит сумму
4. Операция сохраняется в Notion и локальной истории
5. Можно получить отчёты по расходам за неделю/месяц

## Интеграция с Notion

- Все операции автоматически записываются в базу данных Notion.
- Для отчётов бот делает запросы к Notion и группирует расходы по валютам.

## Структура проекта

- `bot.js` — основной файл запуска Telegram-бота
- `handlers/` — обработчики команд, финансовых операций, клавиатур и состояния
- `notion.js` — функции для работы с Notion API
- `config.js` — конфигурация и константы

## Пример использования

1. Нажмите "Запустить бота" в Telegram
2. Следуйте пошаговым инструкциям: выберите тип, валюту, введите сумму
3. Получите подтверждение и отчёты
